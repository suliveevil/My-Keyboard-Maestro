{
	"UID": "A8C0BF6E-C261-4595-97CF-F0E35C52CD29",
	"Actions": [
		{
			"MacroActionType": "ExecuteAppleScript",
			"NotifyOnFailure": false,
			"TrimResults": true,
			"TimeOutAbortsMacro": true,
			"Text": "(* PROPERTIES *)\nproperty LF : (ASCII character 10)\nproperty LF1 : (ASCII character 32) & (ASCII character 32) & (ASCII character 10)\nproperty tid : AppleScript's text item delimiters\n\n\n(* THE SCRIPT *)\ntell application \"Skim\"\n\t\n\t--get info for all notes\n\tset allNotes to every note of document 1\n\tset allNotes_types to every type of notes of document 1\n\tset allNotes_text to text of every note of document 1\n\tset allNotes_pages to index of every page of every note of document 1\n\t\n\t--get info for all notes except top 3\n\tset selNotes to items 4 through -1 of allNotes\n\tset selNotes_types to items 4 through -1 of allNotes_types\n\tset selNotes_text to items 4 through -1 of allNotes_text\n\tset selNotes_pages to items 4 through -1 of allNotes_pages\n\t\n\t--get info from those top 3 notes\n\tset Markdownlink to (get text of note 2 of page 1 of document 1) as string\n\tset pdfTitle to (get extended text of note 1 of page 1 of document 1) as string\n\tset PDFLink to (get text of note 1 of page 1 of document 1) as string\n\tset number_of_Note3 to (get text of note 3 of page 1 of document 1) as string\n\t\n\t--prepare Headers for all of the various note types\n\tset notesText_text to \"<hr />\" & LF & LF & \"<h2>The ToC</h2>\" & LF1 & LF & LF\n\tset notesText_anchor to \"<hr />\" & LF & LF & \"<h2>Comments</h2>\" & LF1 & LF & LF\n\tset notesText_highlight to \"<hr />\" & LF & LF & \"<h2>Highlights</h2>\" & LF1 & LF & LF\n\tset notesText_underline to \"<hr />\" & LF & LF & \"<h2>Underlines</h2>\" & LF1 & LF & LF\n\tset notesText_strikethru to \"<hr />\" & LF & LF & \"<h2>Strike-Throughs</h2>\" & LF1 & LF & LF\n\t\n\t\n\t(* THE MEAT-N-POTATOES OF THE SCRIPT *)\n\trepeat with i from 1 to count of selNotes_types\n\t\t\n\t\t--prepare Skim page # and actual page #\n\t\tset notePage to item i of selNotes_pages\n\t\tset theRealPage to notePage + number_of_Note3 as string\n\t\t\n\t\t--collect Text Notes\n\t\tif item i of selNotes_types is text note then\n\t\t\tset noteText to item i of selNotes_text\n\t\t\tset notesText_text to notesText_text & \"<p>\" & noteText & \" (<a href=\\\"\" & PDFLink & notePage & \"\\\">\" & \"p.\" & theRealPage & \"</a>)\" & LF & LF\n\t\t\t\n\t\t\t--collect Anchor Notes\t\n\t\telse if item i of selNotes_types is anchored note then\n\t\t\tset titleText to item i of selNotes_text\n\t\t\tset noteText to extended text of item i of selNotes\n\t\t\tset notesText_anchor to notesText_anchor & \"<p><strong>\" & titleText & \":</strong> \" & noteText & \" (<a href=\\\"\" & PDFLink & notePage & \"\\\">p.\" & theRealPage & \"</a>)\" & LF & LF\n\t\t\t\n\t\t\t--collect Underline Notes\t\n\t\telse if item i of selNotes_types is underline note then\n\t\t\tset noteText to item i of selNotes_text\n\t\t\tset notesText_underline to notesText_underline & \"<p>\\\"\" & noteText & \"\\\"\" & \" (<a href=\\\"\" & PDFLink & notePage & \"\\\">\" & \"p.\" & theRealPage & \"</a>)\" & LF & LF\n\t\t\t\n\t\t\t--collect Strike-Thru Notes\t\n\t\telse if item i of selNotes_types is strike out note then\n\t\t\tset noteText to item i of selNotes_text\n\t\t\tset notesText_strikethru to notesText_strikethru & \"<p>\\\"\" & noteText & \"\\\"\" & \" (<a href=\\\"\" & PDFLink & notePage & \"\\\">\" & \"p.\" & theRealPage & \"</a>)\" & LF & LF\n\t\t\t\n\t\t\t--collect Highlight Notes\t\n\t\telse if item i of selNotes_types is highlight note then\n\t\t\tset theColor to color of item i of selNotes\n\t\t\tset titleText to my color2text(theColor)\n\t\t\tset noteText to item i of selNotes_text\n\t\t\t\n\t\t\tset notesText_highlight to notesText_highlight & \"<p><strong>\" & titleText & \":</strong> \" & LF1 & \"\\\"\" & noteText & \"\\\"\" & \" (<a href=\\\"\" & PDFLink & notePage & \"\\\">p.\" & theRealPage & \"</a>)\" & LF & LF\n\t\tend if\n\tend repeat\n\t\n\t--extract only the \"Summary\" highlight notes\n\tset theSummary to {}\n\tset theParas to paragraphs of notesText_highlight\n\trepeat with i from 1 to count of theParas\n\t\tif item i of theParas contains \"<p><strong>ref:\" then\n\t\t\tset theTitle to item i of theParas\n\t\t\tset theText to item (i + 1) of theParas\n\t\t\tset theSumm to theTitle & LF & theText & LF & LF\n\t\t\tcopy theSumm to the end of theSummary\n\t\tend if\n\tend repeat\n\t\n\t--remove \"Summary\" highlight notes from collection of highlight notes\n\tif (not (theSummary is {})) then\n\t\tset SumText to theSummary as string\n\t\tset SumList to paragraphs of SumText\n\t\tset empty to {\"\"}\n\t\tset FinalSum to my cleanmyList(SumList, empty)\n\t\t\n\t\tset HighList to paragraphs of notesText_highlight\n\t\tset finalHighlights to my cleanmyList(HighList, FinalSum)\n\t\tset AppleScript's text item delimiters to LF\n\t\tset notesText_highlight to (finalHighlights as string)\n\t\tset theSummary to \"<hr />\" & LF & LF & \"<h2>References</h2>\" & LF1 & LF & LF & SumText\n\tend if\n\t--ALWAYS RETURN TEXT ITEM DELIMITERS TO NORMAL\n\tset AppleScript's text item delimiters to tid\n\t\n\t--remove any note sections that are empty\n\tset FinalList to my textCheck(notesText_text, notesText_anchor, notesText_highlight, notesText_underline, notesText_strikethru, theSummary)\n\t\n\t--prepare the final collection of notes, with MetaData\n\tset FinalText to FinalList\n\t\n\t--create new Evernote note\n\ttell application \"Evernote\"\n\t\t\n\t\t--create new \"notes\" tag if necessary\n\t\tif (not (tag named \"notes\" exists)) then\n\t\t\tset theTag to make tag with properties {name:\"notes\"}\n\t\telse\n\t\t\tset theTag to tag \"notes\"\n\t\tend if\n\t\t\n\t\t--create new \"__\" notebook if necessary\n\t\tif (not (notebook named \"__\" exists)) then\n\t\t\tmake notebook with properties {name:\"__\"}\n\t\tend if\n\t\t\n\t\tset theTitle to \"Notes: \" & pdfTitle\n\t\tset newNote to create note title theTitle with html FinalText notebook \"__\"\n\t\tassign theTag to newNote\n\tend tell\n\t\nend tell\n\n\n\n\n\n\n\n\n\n(* HANDLERS *)\n\n--convert highlights into text values\non color2text(noteColor)\n\tset colorText to {}\n\t\n\tif noteColor is {65535, 65531, 2689, 65535} then\n\t\tset end of colorText to \"n\"\n\telse if noteColor is {49560, 60542, 23241, 65535} then\n\t\tset end of colorText to \"grp\"\n\telse if noteColor is {38537, 46063, 61931, 65535} then\n\t\tset end of colorText to \"pt\"\n\telse if noteColor is {59898, 37357, 50126, 65535} then\n\t\tset end of colorText to \"attn\"\n\telse if noteColor is {59859, 51605, 65183, 65535} then\n\t\tset end of colorText to \"ref\"\n\tend if\n\t\n\treturn colorText\nend color2text\n\n\n--generate random link IDs\non randomize(theVal)\n\tset theAlphabet to {\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\", \"i\", \"j\", \"k\", \"l\", \"m\", \"n\", \"o\", \"p\", \"q\", \"r\", \"s\", \"t\", \"u\", \"v\", \"w\", \"x\", \"y\", \"z\"}\n\tset randomLetter to random number from 1 to 26\n\tset randomLetter to item randomLetter of theAlphabet\n\tset theNum1 to random number from 1 to 9\n\tset theNum2 to random number from 1 to 9\n\tset LinkID to theVal & theNum1 & theNum2 & randomLetter\n\treturn LinkID\nend randomize\n\n--remove any empty note sections\non textCheck(notesText_text, notesText_anchor, notesText_highlight, notesText_underline, notesText_strikethru, theSummary)\n\t\n\tif notesText_text is \"<hr />\n\n<h2>The ToC</h2>  \n\n\n\" then\n\t\tset notesText_text to \"\"\n\telse\n\t\tset notesText_text to notesText_text & LF & LF\n\tend if\n\t\n\tif notesText_anchor is \"<hr />\n\n<h2>Comments</h2>  \n\n\n\" then\n\t\tset notesText_anchor to \"\"\n\telse\n\t\tset notesText_anchor to notesText_anchor & LF & LF\n\tend if\n\t\n\tif notesText_highlight is \"<hr />\n\n<h2>Highlights</h2>  \n\n\n\" then\n\t\tset notesText_highlight to \"\"\n\telse\n\t\tset notesText_highlight to notesText_highlight & LF & LF\n\tend if\n\t\n\tif notesText_underline is \"<hr />\n\n<h2>Underlines</h2>  \n\n\n\" then\n\t\tset notesText_underline to \"\"\n\telse\n\t\tset notesText_underline to notesText_underline & LF & LF\n\tend if\n\t\n\tif notesText_strikethru is \"<hr />\n\n<h2>Strike-Throughs</h2>  \n\n\n\" then\n\t\tset notesText_strikethru to \"\"\n\telse\n\t\tset notesText_strikethru to notesText_strikethru & LF & LF\n\tend if\n\t\n\tif theSummary is {} then\n\t\tset theSummary to \"\"\n\telse\n\t\tset theSummary to theSummary & LF & LF\n\tend if\n\t\n\treturn notesText_text & theSummary & notesText_anchor & notesText_highlight & notesText_underline & notesText_strikethru\nend textCheck\n\n--remove items from a list\non cleanmyList(theList, itemsToDelete)\n\tset cleanList to {}\n\trepeat with i from 1 to count theList\n\t\tif {theList's item i} is not in itemsToDelete then set cleanList's end to theList's item i\n\tend repeat\n\treturn cleanList\nend cleanmyList\n",
			"Path": "",
			"TrimResultsNew": true,
			"StopOnFailure": false,
			"IncludeStdErr": false,
			"DisplayKind": "None",
			"UseText": true
		}
	],
	"CreationDate": 566900688.274131,
	"IsActive": false,
	"ModificationDate": 567315120.975326,
	"Triggers": [
		{
			"FireType": "Pressed",
			"KeyCode": 14,
			"Modifiers": 6656,
			"MacroTriggerType": "HotKey"
		}
	],
	"Name": "key.SK.as.exp.EN"
}