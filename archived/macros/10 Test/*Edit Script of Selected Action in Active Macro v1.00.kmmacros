<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<array>
	<dict>
		<key>Activate</key>
		<string>Normal</string>
		<key>CreationDate</key>
		<real>568122691.47241497</real>
		<key>Macros</key>
		<array>
			<dict>
				<key>Actions</key>
				<array>
					<dict>
						<key>ActionColor</key>
						<string>Aqua</string>
						<key>ActionName</key>
						<string>Macro Notes</string>
						<key>MacroActionType</key>
						<string>Comment</string>
						<key>StyledText</key>
						<data>
						cnRmZAAAAAADAAAAAgAAAAcAAABU
						WFQucnRmAQAAAC6bBQAAKwAAAAEA
						AACTBQAAe1xydGYxXGFuc2lcYW5z
						aWNwZzEyNTJcY29jb2FydGYxNTA0
						XGNvY29hc3VicnRmODMwCntcZm9u
						dHRibFxmMFxmc3dpc3NcZmNoYXJz
						ZXQwIEhlbHZldGljYTt9CntcY29s
						b3J0Ymw7XHJlZDI1NVxncmVlbjI1
						NVxibHVlMjU1O30Ke1wqXGV4cGFu
						ZGVkY29sb3J0Ymw7O30KXHBhcmRc
						dHg1NjBcdHgxMTIwXHR4MTY4MFx0
						eDIyNDBcdHgyODAwXHR4MzM2MFx0
						eDM5MjBcdHg0NDgwXHR4NTA0MFx0
						eDU2MDBcdHg2MTYwXHR4NjcyMFxw
						YXJkaXJuYXR1cmFsXHBhcnRpZ2h0
						ZW5mYWN0b3IwCgpcZjBcZnMyNCBc
						Y2YwIFwnYjdcJ2I3XCdiN1wnYjdc
						J2I3XCdiN1wnYjdcJ2I3XCdiN1wn
						YjdcJ2I3XCdiN1wnYjdcJ2I3XCdi
						N1wnYjdcJ2I3XCdiN1wnYjdcJ2I3
						XCdiN1wnYjdcJ2I3XCdiN1wnYjdc
						J2I3XCdiN1wnYjdcJ2I3XCdiN1wn
						YjdcJ2I3XCdiN1wnYjdcJ2I3XCdi
						N1wnYjdcJ2I3XCdiN1wnYjdcJ2I3
						XCdiN1wnYjdcJ2I3XCdiN1wnYjdc
						J2I3XCdiN1wnYjdcJ2I3XCdiN1wn
						YjdcJ2I3XCdiN1wnYjdcJ2I3XCdi
						N1wnYjdcJ2I3XCdiN1wnYjdcJ2I3
						XCdiN1wnYjdcJ2I3XCdiN1wnYjdc
						J2I3XCdiN1wnYjdcJ2I3XCdiN1wn
						YjdcJ2I3XCdiN1wnYjdcJ2I3XCdi
						N1wnYjdcJ2I3XCdiN1wnYjdcJ2I3
						XCdiN1wnYjdcJ2I3XCdiN1wnYjdc
						J2I3XCdiN1wnYjdcJ2I3XCdiN1wn
						YjdcJ2I3XCdiN1wnYjdcJ2I3XCdi
						N1wnYjdcJ2I3XCdiN1wnYjdcJ2I3
						XCdiN1wnYjdcJ2I3XCdiN1wKQXV0
						aG9yCTogIENocmlzdG9waGVyIFN0
						b25lIDxzY3JpcHRtZWlzdGVyQHRo
						ZXN0b25lZm9yZ2UuY29tPlwKQ3Jl
						YXRlZAk6ICAyMDE4LzA4LzAyIDAy
						OjQ2XApNb2RpZmllZAk6ICAyMDE4
						LzA4LzAyIDA0OjU5XApUYWdzCQk6
						ICBAY2NzdG9uZSwgQEFwcGxlU2Ny
						aXB0LCBARWRpdCwgQFRleHRfU2Ny
						aXB0LCBAU2NyaXB0X0ZpbGVcClRh
						c2s6CTogIEVkaXQgdGhlIGZpbGUg
						KG9yIFRleHQpIG9mIHRoZSBzZWxl
						Y3RlZCBBY3Rpb24gaW4gdGhlIEFj
						dGl2ZSBNYWNyby5cClwnYjdcJ2I3
						XCdiN1wnYjdcJ2I3XCdiN1wnYjdc
						J2I3XCdiN1wnYjdcJ2I3XCdiN1wn
						YjdcJ2I3XCdiN1wnYjdcJ2I3XCdi
						N1wnYjdcJ2I3XCdiN1wnYjdcJ2I3
						XCdiN1wnYjdcJ2I3XCdiN1wnYjdc
						J2I3XCdiN1wnYjdcJ2I3XCdiN1wn
						YjdcJ2I3XCdiN1wnYjdcJ2I3XCdi
						N1wnYjdcJ2I3XCdiN1wnYjdcJ2I3
						XCdiN1wnYjdcJ2I3XCdiN1wnYjdc
						J2I3XCdiN1wnYjdcJ2I3XCdiN1wn
						YjdcJ2I3XCdiN1wnYjdcJ2I3XCdi
						N1wnYjdcJ2I3XCdiN1wnYjdcJ2I3
						XCdiN1wnYjdcJ2I3XCdiN1wnYjdc
						J2I3XCdiN1wnYjdcJ2I3XCdiN1wn
						YjdcJ2I3XCdiN1wnYjdcJ2I3XCdi
						N1wnYjdcJ2I3XCdiN1wnYjdcJ2I3
						XCdiN1wnYjdcJ2I3XCdiN1wnYjdc
						J2I3XCdiN1wnYjdcJ2I3XCdiN1wn
						YjdcJ2I3XCdiN1wnYjdcJ2I3XCdi
						N1wnYjdcJ2I3XCdiN1wnYjdcJ2I3
						XCdiN30BAAAAIwAAAAEAAAAHAAAA
						VFhULnJ0ZhAAAAAL1mJbtgEAAAAA
						AAAAAAAA
						</data>
						<key>Title</key>
						<string>Edit Script of Selected Action in Active Macro v1.00</string>
					</dict>
					<dict>
						<key>DisplayKind</key>
						<string>None</string>
						<key>IncludeStdErr</key>
						<true/>
						<key>MacroActionType</key>
						<string>ExecuteAppleScript</string>
						<key>NotifyOnFailure</key>
						<false/>
						<key>Path</key>
						<string></string>
						<key>StopOnFailure</key>
						<false/>
						<key>Text</key>
						<string>----------------------------------------------------------------
# Auth: Christopher Stone { Heavy Lifting by Shane Stanley }
# dCre: 2018/08/01 16:09
# dMod: 2018/08/02 05:20
# Appl: Keyboard Maestro
# Task: Edit the Selected 'Execute an AppleScript' Action's (text-script OR script-file).
# Libs: None
# Osax: None
# Tags: @Applescript, @Script, @ASObjC, @Keyboard_Maestro, @Edit, @Selected, @Action, @Script_Text, @Text_Script
# Vers: 1.00
----------------------------------------------------------------
use AppleScript version "2.4"
use framework "Foundation"
use scripting additions
----------------------------------------------------------------

try
	
	tell application "Keyboard Maestro"
		set selectedItemList to selection
		
		if length of selectedItemList = 1 then
			set selectedItem to item 1 of selectedItemList
		else if length of selectedItemList &gt; 1 then
			error "Too many items were selected in the Keyboard Maestro Editor!"
		end if
		
		if class of selectedItem = macro group then
			
			error "Please select an 'Execute an AppleScript' action!"
			
		else if class of selectedItem = macro then
			
			setFocusToActionPanelOfKeyboardMaestroEditor() of me
			
			set selectedItemList to selection
			
			if length of selectedItemList = 1 then
				set selectedItem to item 1 of selectedItemList
			else if length of selectedItemList &gt; 1 then
				error "Too many items were selected in the Keyboard Maestro Editor!"
			end if
			
		end if
		
		if class of selectedItem = action then
			copy selectedItem to selectedAction
			
			tell selectedAction to set theXML to its xml
			
		end if
		
	end tell
	
	set appleScriptRecord to its convertPlistToAS:theXML isPath:false
	
	if MacroActionType of appleScriptRecord ¡Ù "ExecuteAppleScript" then
		error "The selected action is an incorrect action-type!" &amp; linefeed &amp; linefeed &amp; "An 'ExecuteAppleScript' action is required!"
	end if
	
	if (UseText of appleScriptRecord) = true then
		
		set scriptText to |text| of appleScriptRecord
		openScriptSourceInScriptDebugger(scriptText) of me
		return
		
	else if (UseText of appleScriptRecord) = false then
		
		set scriptPath to |path| of appleScriptRecord
		
		if scriptPath starts with "~" then
			set scriptPath to ((current application's NSString's stringWithString:scriptPath)'s stringByExpandingTildeInPath) as text
		end if
		
		if itemExists(scriptPath) of me then
			openScriptFileInScriptDebugger(scriptPath) of me
			return
		else
			error "No file exists at path:" &amp; linefeed &amp; linefeed &amp; scriptPath
		end if
		
	end if
	
on error e number n
	set e to e &amp; return &amp; return &amp; "Num: " &amp; n
	if n ¡Ù -128 then
		try
			tell application (path to frontmost application as text) to set ddButton to button returned of ?
				(display dialog e with title "ERROR!" buttons {"Copy Error Message", "Cancel", "OK"} ?
					default button "OK" giving up after 30)
			if ddButton = "Copy Error Message" then set the clipboard to e
		end try
	end if
end try

----------------------------------------------------------------
--? HANDLERS
----------------------------------------------------------------
on convertPlistToAS:plistStringOrPath isPath:isPath
	if isPath then -- read file as data
		set theData to current application's NSData's dataWithContentsOfFile:plistStringOrPath
	else -- it's a string, convert to data
		set aString to current application's NSString's stringWithString:plistStringOrPath
		set theData to aString's dataUsingEncoding:(current application's NSUTF8StringEncoding)
	end if
	-- convert to Cocoa object
	set {theThing, theError} to current application's NSPropertyListSerialization's propertyListWithData:theData options:0 |format|:(missing value) |error|:(reference)
	if theThing is missing value then error (theError's localizedDescription() as text) number -10000
	-- we don't know the class of theThing for coercion, so...
	if (theThing's isKindOfClass:(current application's NSArray)) as integer = 1 then
		return theThing as list
	else
		return item 1 of (theThing as list)
	end if
end convertPlistToAS:isPath:
----------------------------------------------------------------
on itemExists(pathStr)
	try
		if pathStr is "~" or pathStr is "~/" then
			set pathStr to (POSIX path of (path to home folder as text))
		else if pathStr starts with "~/" then
			set pathStr to (POSIX path of (path to home folder as text)) &amp; text 3 thru -1 of pathStr
		end if
		if pathStr starts with "/" then
			alias POSIX file pathStr
		else
			alias pathStr
		end if
		return true
	on error
		return false
	end try
end itemExists
----------------------------------------------------------------
on openScriptFileInScriptDebugger(scriptPath)
	tell application "Script Debugger"
		open scriptPath
		activate
	end tell
end openScriptFileInScriptDebugger
----------------------------------------------------------------
on openScriptSourceInScriptDebugger(scriptText)
	tell application "Script Debugger"
		make new document with properties {source text:scriptText}
		activate
		set bounds of front window to {606, 23, 1920, 1196}
	end tell
end openScriptSourceInScriptDebugger
----------------------------------------------------------------
--? Select Macro or Group Name Field for Editing
----------------------------------------------------------------
on setFocusToActionPanelOfKeyboardMaestroEditor()
	tell application "System Events"
		tell application process "Keyboard Maestro"
			set frontmost to true
			tell window "Keyboard Maestro Editor"
				tell group 1
					tell splitter group 1
						tell scroll area 3
							
							tell scroll bar 1
								if value ¡Ù 0 then set value to 0
							end tell
							
							tell (first text field whose accessibility description is "Macro Name")
								set focused to true
							end tell
							
							keystroke tab
							
						end tell
					end tell
				end tell
			end tell
		end tell
	end tell
end setFocusToActionPanelOfKeyboardMaestroEditor
----------------------------------------------------------------
</string>
						<key>TimeOutAbortsMacro</key>
						<true/>
						<key>TrimResults</key>
						<true/>
						<key>TrimResultsNew</key>
						<true/>
						<key>UseText</key>
						<true/>
					</dict>
				</array>
				<key>CreationDate</key>
				<real>554888615.02313697</real>
				<key>IsActive</key>
				<false/>
				<key>ModificationDate</key>
				<real>568016030.81906104</real>
				<key>Name</key>
				<string>Edit Script of Selected Action in Active Macro v1.00</string>
				<key>Triggers</key>
				<array>
					<dict>
						<key>FireType</key>
						<string>Pressed</string>
						<key>KeyCode</key>
						<integer>31</integer>
						<key>MacroTriggerType</key>
						<string>HotKey</string>
						<key>Modifiers</key>
						<integer>4096</integer>
					</dict>
				</array>
				<key>UID</key>
				<string>37631C61-02E6-442E-AE97-5AB3F3B00246</string>
			</dict>
		</array>
		<key>Name</key>
		<string>10 Test</string>
		<key>ToggleMacroUID</key>
		<string>21C9FAF5-4489-4CBD-8436-9C9F6E733D38</string>
		<key>UID</key>
		<string>DF9C421C-0294-4CC7-9C59-7CDEB233268E</string>
	</dict>
</array>
</plist>
